html
	head
		style
			include css/progressBar.css

	block content
	center
		span
		h1 Text your votes to (812) 420-1234!
		img(src= "http://i.imgur.com/I90I6Xg.png" style="height:183px;")
		img(src= "http://i.imgur.com/Z7qV5LL.png" style="width:116px;height:183px;")

	div.progressWrapper
		-choices.forEach(function(choice){
			center 
				h2(style=" color: blue;") #{choice.title} ----- Text "#{choice.animeID}"
				//h4(id= "tally" + choice.animeID) #{choice.votes}
			div.progressBar
				span(id= choice.animeID).progressBarFill
		-});
	br
	br
	center
		a(href="/new.html") Add New Anime Choice
		br
		br
		a(href="/resetvotes") Reset Votes
		br
		br
		a(href="/reset") Reset Everything

	script var data = !{JSON.stringify(choices)}
	script var animeVotes = [];
	script.
		data.forEach(function(anime){
			var bar = document.getElementById(anime.animeID);
			bar.style = "width: " + (2* anime.votes) + "%;";
			animeVotes.push(anime.votes);
		});

	script(src="/socket.io/socket.io.js")
	script.
		var socket = io.connect('/');
		console.log("Connected to socket.");
		socket.on('vote', function(msg){
			console.log("Incoming vote!");
			console.log(msg.vote);
			animeVotes[msg.vote - 1]++;
			var bar = document.getElementById(msg.vote);
			bar.style = "width: " + (animeVotes[msg.vote - 1] * 2) + "%;"; 
			// This is pretty hacky but it works. :^)
		});		

	// Note that JQuery 1.6 has a += operator. 
	// $( '#new' ).css( 'top', '+=10px' );